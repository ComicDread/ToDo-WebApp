{"ast":null,"code":"var _jsxFileName = \"/Users/andrea/Desktop/ITS Prodigi/Seacom/Application/Todo/Full Stack ToDo login 1.1 copia/client/src/components/Register.js\",\n  _s = $RefreshSig$();\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Login() {\n  _s();\n  const navigate = useNavigate();\n  const [addUserMutation] = useMutation(CREATE_USER);\n  const [currentUserToken, setCurrentUserToken] = useState(null);\n  const [currentUserName, setCurrentUserName] = useState(null);\n  const [currentUserImg, setCurrentUserImg] = useState(null);\n  const [isRegistered, setIsRegistered] = useState(false);\n  useEffect(() => {\n    console.log('user:' + currentUserToken);\n  }, []);\n  function NavigateTo() {\n    navigate('/Register');\n  }\n  const handleSuccess = async credentialResponse => {\n    var decoded = jwt_decode(credentialResponse.credential);\n    const token = decoded.sub;\n    const {\n      data\n    } = await client.query({\n      query: CHECK_USER,\n      variables: {\n        token: token\n      }\n    });\n    console.log(data);\n    if (!data.CheckUser) {\n      await addUserMutation({\n        variables: {\n          token: token,\n          name: decoded.name,\n          email: decoded.email\n        },\n        update(cache, _ref) {\n          let {\n            data\n          } = _ref;\n          const newUserData = {\n            _id: data.newUser._id,\n            userName: data.newUser.userName\n          };\n          console.log(data);\n          const updated = {\n            CheckUser: {\n              ...data.CheckUser,\n              ...newUserData\n            }\n          };\n          client.writeQuery({\n            query: CHECK_USER,\n            variables: {\n              token: token\n            },\n            data: updated\n          });\n        }\n      });\n      localStorage.setItem('currentUser', JSON.stringify(decoded.sub));\n      localStorage.setItem('currentUserName', JSON.stringify(decoded.given_name));\n      localStorage.setItem('currentUserImg', JSON.stringify(decoded.picture));\n      navigate('/');\n    } else {\n      setIsRegistered(true);\n    }\n  };\n  const handleError = () => {\n    console.log('Login Failed');\n  };\n  if (isRegistered) {\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"loginpage\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Mhh...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"This account seems to be registered already\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          children: [\"Move to \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"#\",\n            className: \"redirectRegister\",\n            onClick: NavigateTo,\n            children: \"Login Page!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }, this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"signInButton\",\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(GoogleOAuthProvider, {\n        clientId: \"1038509275601-a2gf0vtu5pt81as8586gt0hsqrqis0mh.apps.googleusercontent.com\",\n        children: /*#__PURE__*/_jsxDEV(GoogleLogin, {\n          onSuccess: handleSuccess,\n          onError: handleError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this);\n  }\n}\n_s(Login, \"Hu1AibNlD1kGx5+040XROkuUaUA=\", true);\n_c = Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["Login","_s","navigate","useNavigate","addUserMutation","useMutation","CREATE_USER","currentUserToken","setCurrentUserToken","useState","currentUserName","setCurrentUserName","currentUserImg","setCurrentUserImg","isRegistered","setIsRegistered","useEffect","console","log","NavigateTo","handleSuccess","credentialResponse","decoded","jwt_decode","credential","token","sub","data","client","query","CHECK_USER","variables","CheckUser","name","email","update","cache","_ref","newUserData","_id","newUser","userName","updated","writeQuery","localStorage","setItem","JSON","stringify","given_name","picture","handleError","_jsxDEV","className","children","fileName","_jsxFileName","lineNumber","columnNumber","href","onClick","id","style","display","justifyContent","alignItems","GoogleOAuthProvider","clientId","GoogleLogin","onSuccess","onError","_c","$RefreshReg$"],"sources":["/Users/andrea/Desktop/ITS Prodigi/Seacom/Application/Todo/Full Stack ToDo login 1.1 copia/client/src/components/Register.js"],"sourcesContent":["export default function Login() {\n    const navigate = useNavigate();\n    const [addUserMutation] = useMutation(CREATE_USER);\n    const [currentUserToken, setCurrentUserToken] = useState(null);\n    const [currentUserName, setCurrentUserName] = useState(null);\n    const [currentUserImg, setCurrentUserImg] = useState(null);\n    const [isRegistered, setIsRegistered] = useState(false); \n  \n    useEffect(() => {\n      console.log('user:' + currentUserToken);\n    }, []);\n  \n    function NavigateTo() {\n      navigate('/Register');\n    }\n  \n    const handleSuccess = async (credentialResponse) => {\n      var decoded = jwt_decode(credentialResponse.credential);\n      const token = decoded.sub;\n      const { data } = await client.query({\n        query: CHECK_USER,\n        variables: { token: token }\n      });\n      console.log(data);\n      if (!data.CheckUser) {\n        await addUserMutation({\n          variables: {\n            token: token,\n            name: decoded.name,\n            email: decoded.email\n          },\n          update(cache, { data }) {\n            const newUserData = {\n              _id: data.newUser._id,\n              userName: data.newUser.userName,\n            }\n            console.log(data);\n            const updated = {\n              CheckUser: { ...data.CheckUser, ...newUserData }\n            };\n  \n            client.writeQuery({\n              query: CHECK_USER,\n              variables: { token: token },\n              data: updated\n            });\n          }\n        });\n        localStorage.setItem('currentUser', JSON.stringify(decoded.sub));\n        localStorage.setItem('currentUserName', JSON.stringify(decoded.given_name));\n        localStorage.setItem('currentUserImg', JSON.stringify(decoded.picture));\n        navigate('/');\n      } else {\n        setIsRegistered(true);\n      }\n    };\n  \n  \n    const handleError = () => {\n      console.log('Login Failed');\n    };\n  \n    if (isRegistered) {\n      return (\n        <main className='loginpage'>\n          <div>\n            <h1>Mhh...</h1>\n            <h2>This account seems to be registered already</h2>\n            <h2>Move to <a href=\"#\" className='redirectRegister' onClick={NavigateTo}>Login Page!</a></h2>\n          </div>\n        </main>\n      );\n    } else {\n      return (\n        <div id=\"signInButton\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n          <GoogleOAuthProvider clientId=\"1038509275601-a2gf0vtu5pt81as8586gt0hsqrqis0mh.apps.googleusercontent.com\">\n            <GoogleLogin onSuccess={handleSuccess} onError={handleError} />\n          </GoogleOAuthProvider>\n        </div>\n      );\n    }\n  }\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}